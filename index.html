<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fillable Table Form</title>
  <style>
    /* Your CSS styles remain unchanged */
  </style>
</head>
<body>
  <form id="tableForm">
    <table>
      <thead>
        <tr>
          <th>Employee Name</th>
          <th>Date</th>
          <th>Plant Name</th>
          <th>Cost Center</th>
          <th>Work Order</th>
          <th>Project</th>
          <th>Task</th>
          <th>Travel</th>
          <th>Time In</th>
          <th>Time Out</th>
          <th>Hours</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <!-- Add 15 rows dynamically using JavaScript -->
      </tbody>
    </table>
    <br>
    <input type="submit" value="Submit">
  </form>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var form = document.getElementById('tableForm');
      form.addEventListener('submit', function(event) {
        event.preventDefault();
        submitForm();
      });

      // Add 15 rows to the table
      var tableBody = document.querySelector('tbody');
      for (var i = 0; i < 15; i++) {
        var row = document.createElement('tr');
        for (var j = 0; j < 12; j++) {
          var cell = document.createElement('td');
          var input;

          if (j === 0) {
            if (i === 0) {
              input = document.createElement('input');
              input.type = 'text';
              input.name = 'row' + i + 'col' + j;
            } else {
              input = document.createElement('span');
              input.innerText = '';
            }
          } else if (j === 1) {
            if (i === 0) {
              input = document.createElement('input');
              input.type = 'date';
              input.name = 'row' + i + 'col' + j;
            } else {
              input = document.createElement('span');
              input.innerText = '';
            }
          } else if (j === 7) {
            input = document.createElement('input');
            input.type = 'text';
            input.name = 'row' + i + 'col' + j;
          } else if (j === 8 || j === 9) {
            input = document.createElement('input');
            input.type = 'time';
            input.name = 'row' + i + 'col' + j;
          } else if (j === 10) {
            input = document.createElement('input');
            input.type = 'text';
            input.name = 'row' + i + 'col' + j;
          } else if (j === 11) {
            input = document.createElement('textarea');
            input.name = 'row' + i + 'col' + j;
          } else {
            input = document.createElement('input');
            input.type = 'text';
            input.name = 'row' + i + 'col' + j;
          }

          cell.appendChild(input);
          row.appendChild(cell);
        }
        tableBody.appendChild(row);
      }
    });

    function submitForm() {
      var formData = new FormData(document.getElementById('tableForm'));

      for (var pair of formData.entries()) {
        if (pair[1].trim() === '') {
          formData.set(pair[0], '-');
        }
      }

      fetch('https://script.google.com/macros/s/AKfycbx8SIM2-6cAkcT9z5K4p4chHjoRtNCbLxl9qWZTW1s-e-N3UvvlTYqY0DL5GJGxXs8C/exec', {
        method: 'POST',
        body: formData
      })
      .then(response => response.json())
      .then(data => {
        console.log(data);
        clearTable();
        window.location.href = 'success-page.html'; // Redirect to the success page
      })
      .catch(error => console.error(error));
    }

    function clearTable() {
      var tableBody = document.querySelector('tbody');
      tableBody.innerHTML = ''; // Clear all rows from the table
    }
  </script>
</body>
</html>
